appId: com.transcriptai.app
productName: TranscriptAI
directories:
  output: dist
files:
  - from: .
    filter:
      - package.json
      - src/**
extraResources:
  # Include the built frontend (relative to desktop/ when running builder)
  - from: ../frontend/dist
    to: frontend_dist
  # Include prebuilt backend (directory for --onedir or binary for --onefile)
  # Place backend directory or binary under backend/bin before packaging
  - from: ../backend/bin
    to: backend
    filter:
      - "**/*"
  # Include cache manager for PyInstaller bundle caching
  - from: ../backend/pyinstaller_cache_manager.js
    to: backend/pyinstaller_cache_manager.js
  # Include native helper for global key listener (macOS)
  - from: node_modules/node-global-key-listener/bin
    to: bin
  # --- Phase 1 & 3: C++ Binaries & Models ---
  - from: ../backend-cpp/whisper-server
    to: whisper-server
  - from: ../backend-cpp
    to: .
    filter:
      - "*.dylib"
  # Only bundle base model for lean DMG (~145MB)
  # Other models (tiny, small) are downloaded on-demand to user data dir
  - from: ../backend-cpp/models/ggml-base.en.bin
    to: models/ggml-base.en.bin
  # ------------------------------------------
mac:
  target: [dmg]
  category: public.app-category.productivity
  compression: store
  icon: build/icon.icns
  # Code Signing (uses Developer ID Application certificate)
  identity: "Balaji Sachidanandam (KVLNE2Y696)"
  hardenedRuntime: true
  gatekeeperAssess: false
  entitlements: build/entitlements.mac.plist
  entitlementsInherit: build/entitlements.mac.plist
  # Notarization (requires env vars: APPLE_ID, APPLE_APP_SPECIFIC_PASSWORD)
  notarize:
    teamId: KVLNE2Y696
dmg:
  contents:
    - x: 130
      y: 220
      type: file
    - x: 410
      y: 220
      type: link
      path: /Applications
  window:
    width: 540
    height: 400
  iconSize: 80
  iconTextSize: 12
win:
  target: [nsis]
  compression: maximum
asar: true
publish:
  provider: github
  owner: sbpk516
  repo: transcriptai
  releaseType: draft
